package com.example.wiprotest;import com.example.wiprotest.model.InstrumentPriceHistory;import com.example.wiprotest.service.Calculator;import com.example.wiprotest.service.CalculatorImpl;import com.example.wiprotest.service.dao.InstrumentPriceModifierDaoImpl;import com.example.wiprotest.utils.InstrumentPriceHistoryReader;import com.zaxxer.hikari.HikariConfig;import com.zaxxer.hikari.HikariDataSource;import javax.sql.DataSource;import java.io.IOException;import java.nio.file.Files;import java.nio.file.Path;import java.sql.SQLException;import java.sql.Statement;import java.util.stream.Stream;public class Main {	public static void main(String[] args) throws Exception {		String inputPath = args[0];		DataSource dataSource = setupDataSource();		Calculator calculator = new CalculatorImpl(new InstrumentPriceModifierDaoImpl(dataSource));		Stream<InstrumentPriceHistory> historyLog = InstrumentPriceHistoryReader.readHistoryLog(Files.lines(Path.of(inputPath)));		calculator.calculatePrices(historyLog);	}	private static DataSource setupDataSource() throws SQLException {		HikariConfig hikariConfig = new HikariConfig();		hikariConfig.setDriverClassName(org.h2.Driver.class.getName());		hikariConfig.setJdbcUrl("jdbc:h2:mem:/h2-testrun-database");		DataSource dataSource = new HikariDataSource(hikariConfig);		try (Statement statement = dataSource.getConnection().createStatement()) {			statement.execute("CREATE TABLE INSTRUMENT_PRICE_MODIFIER(" +				"ID LONG PRIMARY KEY," +				"NAME VARCHAR(128) NOT NULL," +				"MULTIPLIER DOUBLE NOT NULL" +				")");			statement.execute("CREATE INDEX INSTRUMENT_PRICE_MODIFIER_NAME_IDX ON INSTRUMENT_PRICE_MODIFIER(NAME)");			statement.execute("INSERT INTO INSTRUMENT_PRICE_MODIFIER(ID, NAME, MULTIPLIER) VALUES (1, 'INSTRUMENT1', 1.1)");			statement.execute("INSERT INTO INSTRUMENT_PRICE_MODIFIER(ID, NAME, MULTIPLIER) VALUES (2, 'INSTRUMENT2', 1.01)");		}		return dataSource;	}}